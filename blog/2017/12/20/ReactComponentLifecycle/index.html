<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Understanding React component lifecycle | background-color:red</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="IntroductionReact components let you architecture the UI into independent pieces and let each of them have its own lifecycle. This blog post covers the different stages of a component lifecycle and th">
<meta name="keywords" content="JavaScript,React">
<meta property="og:type" content="article">
<meta property="og:title" content="Understanding React component lifecycle">
<meta property="og:url" content="http://www.giulioambrogi.com/blog/2017/12/20/ReactComponentLifecycle/index.html">
<meta property="og:site_name" content="background-color:red">
<meta property="og:description" content="IntroductionReact components let you architecture the UI into independent pieces and let each of them have its own lifecycle. This blog post covers the different stages of a component lifecycle and th">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://www.giulioambrogi.com/blog/2017/12/20/ReactComponentLifecycle/react-component-lifecycle.png">
<meta property="og:updated_time" content="2017-12-20T14:39:23.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Understanding React component lifecycle">
<meta name="twitter:description" content="IntroductionReact components let you architecture the UI into independent pieces and let each of them have its own lifecycle. This blog post covers the different stages of a component lifecycle and th">
<meta name="twitter:image" content="http://www.giulioambrogi.com/blog/2017/12/20/ReactComponentLifecycle/react-component-lifecycle.png">
  
    <link rel="alternate" href="/atom.xml" title="background-color:red" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/blog/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div style="color:#fff">
        <h1 id="title">
            <span id="title-1">background-color:</span>
            <span id="title-square">&nbsp;</span>
            <span id="title-2"> red</span><span id="title-3">;</span>            
        </h1>
      </div>
      <!--<h1 id="logo-wrap">
        <a href="/blog/" id="logo">background-color:red</a>
      </h1>
      -->
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
          <a class="main-nav-link" href="/blog/about">About</a>
        
          <a class="main-nav-link" href="http://www.giulioambrogi.com">Portfolio</a>
        
      </nav>
      <nav id="sub-nav">
        <!--
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        -->
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.giulioambrogi.com/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-ReactComponentLifecycle" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2017/12/20/ReactComponentLifecycle/" class="article-date">
  <time datetime="2017-12-20T14:17:30.000Z" itemprop="datePublished">2017-12-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Understanding React component lifecycle
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>React components let you architecture the UI into independent pieces and let each of them have its own lifecycle. This blog post covers the different stages of a component lifecycle and the APIs that let us control the component behaviour on each specific event.</p>
<p>The lifecycle of a Rect component can be summarized in three key events:<br><a id="more"></a></p>
<ul>
<li><strong>mount</strong>, occurs when the component is being created and attached to the DOM;</li>
<li><strong>unmount</strong>, occurs when the component is being removed from the DOM;</li>
<li><strong>update</strong>, occurs when the component is being updated.</li>
</ul>
<p>React Component API allows us to inject our code at the different stages of the lifecycle. In the sections below you’ll find a description of the API and an <a href="#Example">example</a> of a real case scenario.</p>
<img src="/blog/2017/12/20/ReactComponentLifecycle/react-component-lifecycle.png" alt="Lifecycle APIs" title="Lifecycle APIs">
<h2 id="Mount"><a href="#Mount" class="headerlink" title="Mount"></a>Mount</h2><p>When a component <em>mounts</em> React let us call the following functions:</p>
<ul>
<li><code>constructor()</code>: called before the component is mounted and before the <code>render</code> method. Here’s where you can initialise the component’s state;</li>
<li><code>render()</code>: displays the component and it should be pure function, in other words it should just return a DOM element and should not perform any operation on the state or the properties of the component;</li>
<li><code>componentDidMount()</code>: called after the component is mounted, it’s the right place where you can fetch some data from an API and then call <code>setState</code> to re-render the component after response is received.</li>
<li><code>componentWillMount()</code>: called right before the <code>render</code> method. Keep in mind that it is risky to dispatch actions from the constructor because it may result in mutating the state while rendering. <blockquote>
<p>React community seems very divergent on whether this method is actually useful or not. By the way it can be used to perform <code>setState</code> based on the initial <code>props</code>. </p>
</blockquote>
</li>
</ul>
<h2 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h2><ul>
<li><p><code>componentWillReceiveProps(newProps)</code>: invoked right before the mounted component receives one or more new properties. This method is not called when the component mounts.</p>
</li>
<li><p><code>shouldComponentUpdate(oldProps, newProps)</code>: called right after the components receives the newProperties and used to tell React whether to re-render the component or not.</p>
<blockquote>
<p>The default behaviour is to re-render every time the state changes, and in the vast majority of cases you should rely on the default behaviour.</p>
</blockquote>
</li>
<li><p><code>componentWillUpdate(newProps, newState)</code>: is invoked right before the <code>render</code> method when new props or state are being received. This method is not called when the component mounts.<br>You may want to use this method in case you need to prepare the component before the update.</p>
<blockquote>
<p>Do not update the state here as it  would trigger an update to the component before <code>componentWillUpdate</code> returns</p>
</blockquote>
</li>
<li><p><code>componentDidUpdate()</code>: is invoked after the component has been re-rendered. Sme as <code>componentDidMount</code> this is the right place to perform an async operation.</p>
</li>
<li><p><code>render()</code> same as <em>mount</em>‘s <code>render</code></p>
</li>
</ul>
<h2 id="Unmount"><a href="#Unmount" class="headerlink" title="Unmount"></a>Unmount</h2><p>For the unmount event, React’s API provides only one function:</p>
<ul>
<li><code>componentWillUnmount()</code>: is called immediately before the component is being unmounted.<br>Use case:  perform cleanup operations.</li>
</ul>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>Let’s see a typical use case where <code>constructor</code>, <code>componentDidMount</code>, <code>componentWillReceiveProps</code> and <code>render</code> are being used.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">constructor</span>(props) &#123;</div><div class="line">        <span class="keyword">super</span>(props);</div><div class="line">        <span class="keyword">this</span>.state = &#123;</div><div class="line">            bananas: []</div><div class="line">        &#125;;</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    componentDidMount()&#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> bananas = api.getSomeBananas()</div><div class="line">            .then( <span class="function"><span class="params">bananas</span> =&gt;</span> &#123;</div><div class="line">                <span class="keyword">this</span>.setState(&#123;bananas&#125;);</div><div class="line">            &#125;)        </div><div class="line"></div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    render() &#123;</div><div class="line">        <span class="keyword">return</span> &lt;div&gt;Hello, I've got  &#123;this.state.bananas.length&#125; bananas!&lt;/div&gt;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>In a nutshell:</p>
<p>1 - The component gets created by <code>constructor</code> function, note that the initial state contains an empty array of bananas;<br>2 - The component gets mounted and rendered. So on the screen you’ll see <em>Hello, I’ve got 0 bananas!</em>.<br>3- <code>componentDidMount</code> fires and we fetch some data from <code>api</code>. When we get a response <code>setState</code> is being called.<br>4- <code>setState</code> triggers a new rendering, so <code>render</code> is being called. Let’s say the response contains an array of 10 banans: the message on the screen will be updated to  <em>Hello, I’ve got 10 bananas!</em>.</p>
<!-- **Why performing the API call in `componentDidMount` rather than `componentWillMount`?**
 -->
<p>Now let’s imagine that the components seen above can also receive an <code>availableBananas</code> property from a parent component, such as <code>&lt;BananasComponent availableBananas={anArrayOfBananas} /&gt;</code>.</p>
<p>If at some point at runtime the parent of our <em>ExampleComponent</em> updates the value of <code>availableBananas</code>, our components needs to be able to update his own state with the received value. That’s when <code>componentWillReceiveProps</code> comes in help.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">   </div><div class="line"><span class="comment">//ExampleComponent</span></div><div class="line">componentWillReceiveProps(nextProps)&#123;</div><div class="line">    <span class="keyword">this</span>.setState(&#123;<span class="attr">availableBananas</span>: <span class="keyword">this</span>.props.availableBananas&#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="That’s-not-it"><a href="#That’s-not-it" class="headerlink" title="That’s not it"></a>That’s not it</h2><p>React Component APIs let us handle the component lifecycle with huge flexibility. Whilst their usage seems pretty straightforward the hardest bit is orchestrating the components of your inteface all toghether. In particular some of the key problems to take into account when dealing with multiple components are: minimizing the coupling between them, avoiding unnecessary state propagations back and forth across the DOM tree, handling state immutability and more. Anyway this goes far beyond the purpose of this blog post so I may address them in the future.</p>
<h4 id="References"><a href="#References" class="headerlink" title="References:"></a>References:</h4><ul>
<li><a href="https://facebook.github.io/react/docs/react-component.html" target="_blank" rel="external">https://facebook.github.io/react/docs/react-component.html</a></li>
<li><a href="https://github.com/reactjs/react-redux/issues/129" target="_blank" rel="external">https://github.com/reactjs/react-redux/issues/129</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.giulioambrogi.com/blog/2017/12/20/ReactComponentLifecycle/" data-id="cj860katg0000i0w7kukx0h87" class="article-share-link">Share</a>
      
        <a href="http://www.giulioambrogi.com/blog/2017/12/20/ReactComponentLifecycle/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/JavaScript/">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/React/">React</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/blog/2017/09/25/bind-vs-call-vs-apply/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">bind vs call vs apply</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/React/">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/apply/">apply</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/bind/">bind</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/call/">call</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/front-end/">front-end</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/this/">this</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2017/12/20/ReactComponentLifecycle/">Understanding React component lifecycle</a>
          </li>
        
          <li>
            <a href="/blog/2017/09/25/bind-vs-call-vs-apply/">bind vs call vs apply</a>
          </li>
        
          <li>
            <a href="/blog/2017/09/18/what-is-this-javascript/">What is this in JavaScript</a>
          </li>
        
          <li>
            <a href="/blog/2017/09/17/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Giulio Ambrogi<br>
      <a href="/">www.giulioambrogi.com</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/blog/about" class="mobile-nav-link">About</a>
  
    <a href="http://www.giulioambrogi.com" class="mobile-nav-link">Portfolio</a>
  
</nav>
    
<script>
  var disqus_shortname = 'giulioambrogi';
  
  var disqus_url = 'http://www.giulioambrogi.com/blog/2017/12/20/ReactComponentLifecycle/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">
  <script src="/blog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/blog/js/script.js"></script>

  </div>
</body>
</html>